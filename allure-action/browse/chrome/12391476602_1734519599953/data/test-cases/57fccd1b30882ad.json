{"uid":"57fccd1b30882ad","name":"Admin partial refund options - chrome","fullName":"tests.tests_generation_unic_admin_links.test_admin_link_generation.TestAdminLinkGeneration#test_admin_partial_refund_options","historyId":"7e0fd77fc0171787137c625144a3367a","time":{"start":1734519494939,"stop":1734519494939,"duration":0},"status":"broken","statusMessage":"UnboundLocalError: cannot access local variable 'capabilities' where it is not associated with a value","statusTrace":"request = <SubRequest 'browser' for <Function test_admin_create_uniq_payment_link[default_pricing_button-ar]>>\n\n    @pytest.fixture(scope=\"session\")\n    @allure.title(f\"Set up browser: {os.getenv('BROWSER')}\")\n    def browser(request):\n        desired_cap = {\n            'os': 'osx',\n            'os_version': 'catalina',\n            'browser': os.getenv('BROWSER', 'chrome'),  # allowed browsers are `chrome`, `edge`, `playwright-chromium`, `playwright-firefox` and `playwright-webkit`\n            'browser_version': 'latest', # this capability is valid only for branded `chrome` and `edge` browsers and you can specify any browser version like `latest`, `latest-beta`, `latest-1` and so on.\n            'browserstack.username': \"whitetest_6fgI53\",\n            'browserstack.accessKey': \"QpS1ZTxEnyyZxcDjqoHA\",\n            'browserstack.geoLocation': 'FR',\n            'project': 'My First Project',\n            'build': 'playwright-python-1',\n            'name': 'My First Test',\n            'buildTag': 'reg',\n            'resolution': '1280x1024',\n            'browserstack.local': 'true',\n            'browserstack.localIdentifier': 'local_connection_name',\n            'browserstack.playwrightVersion': '1.latest',\n            'client.playwrightVersion': '1.latest',\n            'browserstack.debug': True,\n            'browserstack.console': \"info\",\n            'browserstack.networkLogs': True,\n            'browserstack.interactiveDebugging': True\n        }\n        with sync_playwright() as p:\n            browser_type = desired_cap['browser']\n            clientPlaywrightVersion = str(subprocess.getoutput('playwright --version')).strip().split(\" \")[1]\n            desired_cap['client.playwrightVersion'] = clientPlaywrightVersion\n            if browser_type == 'chromium':\n                capabilities = {\n                    **desired_cap,\n                    'browser': 'chromium',\n                    'channel': browser_type\n                }\n            if desired_cap.get('browserstack.username') and desired_cap.get('browserstack.accessKey'):\n                ws_endpoint = f'wss://cdp.browserstack.com/playwright?caps=' + urllib.parse.quote(json.dumps(desired_cap))\n>               browser = getattr(p, capabilities['browser']).connect(ws_endpoint)\nE               UnboundLocalError: cannot access local variable 'capabilities' where it is not associated with a value\n\nconftest.py:57: UnboundLocalError","flaky":false,"newFailed":false,"newBroken":false,"newPassed":false,"retriesCount":0,"retriesStatusChange":false,"beforeStages":[{"name":"_session_faker","time":{"start":1734519494395,"stop":1734519494454,"duration":59},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"attachmentsCount":0,"hasContent":false,"stepsCount":0,"attachmentStep":false},{"name":"pytestconfig","time":{"start":1734519494454,"stop":1734519494455,"duration":1},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"attachmentsCount":0,"hasContent":false,"stepsCount":0,"attachmentStep":false},{"name":"delete_output_dir","time":{"start":1734519494455,"stop":1734519494455,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"attachmentsCount":0,"hasContent":false,"stepsCount":0,"attachmentStep":false},{"name":"Set up browser: chrome","time":{"start":1734519494455,"stop":1734519494900,"duration":445},"status":"broken","statusMessage":"UnboundLocalError: cannot access local variable 'capabilities' where it is not associated with a value\n","statusTrace":"  File \"/usr/local/lib/python3.12/dist-packages/pluggy/_callers.py\", line 167, in _multicall\n    teardown.throw(outcome._exception)\n  File \"/usr/local/lib/python3.12/dist-packages/_pytest/setuponly.py\", line 36, in pytest_fixture_setup\n    return (yield)\n            ^^^^^\n  File \"/usr/local/lib/python3.12/dist-packages/pluggy/_callers.py\", line 103, in _multicall\n    res = hook_impl.function(*args)\n          ^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.12/dist-packages/_pytest/fixtures.py\", line 1140, in pytest_fixture_setup\n    result = call_fixture_func(fixturefunc, request, kwargs)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.12/dist-packages/_pytest/fixtures.py\", line 891, in call_fixture_func\n    fixture_result = next(generator)\n                     ^^^^^^^^^^^^^^^\n  File \"/app/workspace/conftest.py\", line 57, in browser\n    browser = getattr(p, capabilities['browser']).connect(ws_endpoint)\n                         ^^^^^^^^^^^^\n","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":true,"attachmentsCount":0,"hasContent":true,"stepsCount":0,"attachmentStep":false},{"name":"_verify_url","time":{"start":1734519494455,"stop":1734519494455,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"attachmentsCount":0,"hasContent":false,"stepsCount":0,"attachmentStep":false},{"name":"base_url","time":{"start":1734519494455,"stop":1734519494455,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"attachmentsCount":0,"hasContent":false,"stepsCount":0,"attachmentStep":false}],"afterStages":[],"labels":[{"name":"feature","value":"Admin link generation - chrome"},{"name":"parentSuite","value":"tests.tests_generation_unic_admin_links"},{"name":"suite","value":"test_admin_link_generation"},{"name":"subSuite","value":"TestAdminLinkGeneration"},{"name":"host","value":"fc16a022c6ec"},{"name":"thread","value":"20-MainThread"},{"name":"framework","value":"pytest"},{"name":"language","value":"cpython3"},{"name":"package","value":"tests.tests_generation_unic_admin_links.test_admin_link_generation"},{"name":"resultFormat","value":"allure2"}],"parameters":[{"name":"language","value":"'ar'"},{"name":"refund_button","value":"'partial_refund_plan_button_keep_subscription'"}],"links":[],"hidden":false,"retry":false,"extra":{"severity":"normal","retries":[],"categories":[{"name":"Test defects","matchedStatuses":[],"flaky":false}],"tags":[]},"source":"57fccd1b30882ad.json","parameterValues":["'ar'","'partial_refund_plan_button_keep_subscription'"]}